# Goodiffer

AI-powered git diff analyzer for code review - åŸºäº AI çš„ Git Diff æ™ºèƒ½åˆ†æå·¥å…·

[![npm version](https://badge.fury.io/js/goodiffer.svg)](https://www.npmjs.com/package/goodiffer)
[![License: MIT](https://img.shields.io/badge/License-MIT-yellow.svg)](https://opensource.org/licenses/MIT)

## Features

- ğŸ¤– æ”¯æŒ Claude (Anthropic) å’Œ GPT (OpenAI) æ¨¡å‹
- ğŸ” è‡ªåŠ¨åˆ†æ git diffï¼Œè¯†åˆ«æ½œåœ¨é—®é¢˜
- ğŸ“Š ç”Ÿæˆç»“æ„åŒ–çš„ä»£ç å®¡æŸ¥æŠ¥å‘Š
- ğŸ”— æ£€æµ‹ä»£ç å…³è”æ€§é£é™©
- ğŸ“‹ ç”Ÿæˆå¯å¤åˆ¶çš„ä¿®å¤æç¤ºè¯ï¼Œæ–¹ä¾¿åœ¨ Claude Code / Codex ä¸­ä½¿ç”¨
- ğŸŒ æ”¯æŒç¬¬ä¸‰æ–¹ API ä»£ç†
- ğŸ”® æ”¯æŒä»£ç ä¸Šä¸‹æ–‡è·å– (Tool Use)ï¼ŒAI å¯æŒ‰éœ€è¯»å–ç›¸å…³æºç 
- âš¡ **NEW** LSP é›†æˆ - æä¾›ç±»å‹ä¿¡æ¯ã€å¼•ç”¨æŸ¥æ‰¾ã€ç¬¦å·å¯¼èˆªç­‰æ™ºèƒ½åŠŸèƒ½
- ğŸ§  **NEW** Codex æ·±åº¦å®¡æŸ¥ - åŸºäº GPT-5.2 çš„ 8 ç»´åº¦æ·±åº¦ä»£ç å®¡æŸ¥

## Installation

```bash
npm install -g goodiffer
```

## Quick Start

```bash
# 1. åˆå§‹åŒ–é…ç½®
goodiffer init

# 2. åˆ†ææœ€è¿‘ä¸€æ¬¡ commit
goodiffer

# 3. æŸ¥çœ‹å¸®åŠ©
goodiffer --help
```

## Usage

### åˆå§‹åŒ–é…ç½®

```bash
goodiffer init
```

äº¤äº’å¼é…ç½®ï¼š
- é€‰æ‹© API Host (Anthropic/OpenAI/PackyAPI/è‡ªå®šä¹‰)
- è¾“å…¥ API Key
- é€‰æ‹©æ¨¡å‹ (claude-sonnet-4-5/gpt-4o/è‡ªå®šä¹‰)

### åˆ†æå‘½ä»¤

```bash
# åˆ†ææœ€è¿‘ä¸€æ¬¡ commit (é»˜è®¤)
goodiffer

# åˆ†ææš‚å­˜åŒº
goodiffer -s
goodiffer --staged

# åˆ†ææŒ‡å®š commit
goodiffer -c <commit-sha>
goodiffer --commit <commit-sha>

# åˆ†æ commit èŒƒå›´
goodiffer --from <start-sha> --to <end-sha>

# åˆ†ææœ€è¿‘ n æ¡ commit (n <= 10)
goodiffer -n 3          # åˆ†ææœ€è¿‘ 3 æ¡ commit
goodiffer -n 5          # åˆ†ææœ€è¿‘ 5 æ¡ commit

# åˆ†æç¬¬ n æ¡åˆ°ç¬¬ m æ¡ commit (m-n <= 10)
goodiffer -n 2 -m 5     # åˆ†æç¬¬ 2 åˆ°ç¬¬ 5 æ¡ commit
goodiffer -n 3 -m 8     # åˆ†æç¬¬ 3 åˆ°ç¬¬ 8 æ¡ commit

# å¯ç”¨ä»£ç ä¸Šä¸‹æ–‡è·å– (AI å¯æŒ‰éœ€è¯»å–ç›¸å…³æºç )
goodiffer --context     # åˆ†ææ—¶ AI å¯ä»¥è¯»å–é¡¹ç›®ä¸­çš„å…¶ä»–æ–‡ä»¶
goodiffer -c abc123 --context  # åˆ†ææŒ‡å®š commitï¼Œå¯ç”¨ä¸Šä¸‹æ–‡
```

### ä»£ç ä¸Šä¸‹æ–‡æ¨¡å¼ (--context)

å¯ç”¨ `--context` é€‰é¡¹åï¼ŒAI åœ¨åˆ†æä»£ç æ—¶å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å·¥å…·ï¼š

#### åŸºç¡€å·¥å…·
1. **read_file** - è¯»å–é¡¹ç›®ä¸­çš„æºæ–‡ä»¶ï¼Œäº†è§£å‡½æ•°/ç±»çš„å…·ä½“å®ç°
2. **find_definition** - æŸ¥æ‰¾å‡½æ•°ã€ç±»ã€å˜é‡çš„å®šä¹‰ä½ç½®
3. **search_code** - åœ¨é¡¹ç›®ä¸­æœç´¢ä»£ç æ¨¡å¼
4. **list_files** - åˆ—å‡ºç›®å½•ç»“æ„

#### LSP å¢å¼ºå·¥å…· (TypeScript/JavaScript)
5. **get_type_info** - è·å–å˜é‡ã€å‡½æ•°çš„ç±»å‹ä¿¡æ¯å’Œæ–‡æ¡£
6. **find_references** - æŸ¥æ‰¾ç¬¦å·åœ¨æ•´ä¸ªé¡¹ç›®ä¸­çš„æ‰€æœ‰å¼•ç”¨ä½ç½®
7. **get_document_symbols** - è·å–æ–‡ä»¶ä¸­çš„æ‰€æœ‰ç¬¦å·åˆ—è¡¨ï¼ˆå‡½æ•°ã€ç±»ã€å˜é‡ç­‰ï¼‰
8. **go_to_definition** - ä½¿ç”¨ LSP ç²¾ç¡®å®šä½ç¬¦å·çš„å®šä¹‰ä½ç½®

**LSP å·¥å…·ä¼˜åŠ¿ï¼š**
- âœ… ç²¾ç¡®çš„ç±»å‹åˆ†æï¼ˆæ”¯æŒ TypeScript/JavaScriptï¼‰
- âœ… è·¨æ–‡ä»¶å¼•ç”¨æŸ¥æ‰¾
- âœ… å¿«é€Ÿäº†è§£æ–‡ä»¶ç»“æ„
- âœ… è‡ªåŠ¨å›é€€åˆ°æ­£åˆ™æœç´¢

è¿™ä½¿å¾— AI èƒ½å¤Ÿï¼š
- éªŒè¯è¢«è°ƒç”¨å‡½æ•°çš„å®ç°æ˜¯å¦æ­£ç¡®
- æ£€æŸ¥ç±»å‹å®šä¹‰å’Œæ¥å£
- å‘ç°æ½œåœ¨çš„å…³è”å½±å“
- äº†è§£ä»£ç çš„è°ƒç”¨å…³ç³»å’Œä¾èµ–

> **æ³¨æ„**: æ­¤åŠŸèƒ½éœ€è¦ Claude æ¨¡å‹ï¼ˆä½¿ç”¨ Tool Use APIï¼‰ã€‚LSP åŠŸèƒ½è‡ªåŠ¨å¯ç”¨ï¼Œæ— éœ€é¢å¤–é…ç½®ã€‚

### Codex æ·±åº¦ä»£ç å®¡æŸ¥ (NEW)

ä½¿ç”¨ OpenAI Codex (GPT-5.2) è¿›è¡Œæ·±åº¦ä»£ç å®¡æŸ¥ï¼Œæä¾› 8 ç»´åº¦è´¨é‡è¯„ä¼°å’Œé«˜æ¨ç†åˆ†æã€‚

```bash
# ä½¿ç”¨ Codex æ·±åº¦å®¡æŸ¥æœ€è¿‘ä¸€æ¬¡ commit
goodiffer codex

# å®¡æŸ¥æš‚å­˜åŒº
goodiffer codex -s

# å®¡æŸ¥æŒ‡å®š commit
goodiffer codex -c abc123

# æŒ‡å®šæ¨ç†å¼ºåº¦ (low/medium/high)
goodiffer codex --reasoning high
```

#### Codex Review ç‰¹æ€§

**8 ç»´åº¦è´¨é‡è¯„ä¼°ï¼š**
1. **Code Style & Formatting** - ä»£ç é£æ ¼ä¸æ ¼å¼
2. **Security & Compliance** - å®‰å…¨æ€§ä¸åˆè§„æ€§
3. **Error Handling & Logging** - é”™è¯¯å¤„ç†ä¸æ—¥å¿—
4. **Readability & Maintainability** - å¯è¯»æ€§ä¸å¯ç»´æŠ¤æ€§
5. **Performance & Scalability** - æ€§èƒ½ä¸å¯æ‰©å±•æ€§
6. **Testing & Quality Assurance** - æµ‹è¯•ä¸è´¨é‡ä¿è¯
7. **Documentation & Version Control** - æ–‡æ¡£ä¸ç‰ˆæœ¬æ§åˆ¶
8. **Accessibility & Internationalization** - å¯è®¿é—®æ€§ä¸å›½é™…åŒ–

**è¯„åˆ†ç³»ç»Ÿï¼š**
- â­ **Extraordinary** (90-100) - å“è¶Šè´¨é‡
- âœ“ **Acceptable** (70-89) - ç¬¦åˆæ ‡å‡†
- âš ï¸ **Poor** (0-69) - éœ€è¦æ”¹è¿›

**é«˜æ¨ç†æ¨¡å¼ï¼š**
- ä½¿ç”¨ `reasoning: { effort: "high" }` è¿›è¡Œæ·±åº¦åˆ†æ
- æä¾›ç½®ä¿¡åº¦è¯„åˆ†ï¼ˆ0.0-1.0ï¼‰
- ç”Ÿæˆæ­£ç¡®æ€§åˆ¤æ–­ï¼ˆpatch is correct / incorrectï¼‰

**ç»“æ„åŒ–è¾“å‡ºï¼š**
- ä½¿ç”¨ JSON Schema å®šä¹‰è¾“å‡ºæ ¼å¼ï¼ˆé™ä½ 35% å¤±è´¥ç‡ï¼‰
- ç²¾ç¡®çš„æ–‡ä»¶/è¡Œå·å¼•ç”¨
- ä¼˜å…ˆçº§åˆ†çº§ï¼ˆP0-P3ï¼‰

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚  Codex Deep Code Review Report                          â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

ğŸ“ Commit: abc1234
ğŸ“‹ Message: feat: add user authentication

ğŸ“Š Summary: æ·»åŠ äº†ç”¨æˆ·è®¤è¯åŠŸèƒ½...

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ 8-Dimensional Quality Assessment

1. Security & Compliance
   ğŸŒŸ Rating: EXTRAORDINARY | Score: 95/100
   å¯†ç åŠ å¯†ä½¿ç”¨äº† bcryptï¼Œç¬¦åˆå®‰å…¨æ ‡å‡†

2. Error Handling & Logging
   âš ï¸ Rating: POOR | Score: 60/100
   ç¼ºå°‘å¼‚å¸¸å¤„ç†å’Œæ—¥å¿—è®°å½•
   â–¸ API è°ƒç”¨æœªå¤„ç†é”™è¯¯æƒ…å†µ
   â–¸ ç¼ºå°‘å…³é”®æ“ä½œçš„æ—¥å¿—

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš–ï¸  Overall Assessment

âœ… Correctness: PATCH IS CORRECT
ğŸ“ˆ Confidence: 85% (High)
ğŸ’¡ Explanation: ä»£ç åŠŸèƒ½æ­£ç¡®ï¼Œä½†éœ€æ”¹è¿›é”™è¯¯å¤„ç†

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ” Findings (2)

ğŸŸ  P1 - URGENT (1)

[A] [P1] API è°ƒç”¨ç¼ºå°‘é”™è¯¯å¤„ç†

   Location: src/auth/api.js:45-52
   Confidence: 90% (Very High)
   Dimension: Error Handling & Logging

   åœ¨ loginUser å‡½æ•°ä¸­ç›´æ¥è°ƒç”¨ API è€Œæœªå¤„ç†å¯èƒ½çš„ç½‘ç»œé”™è¯¯...

   ğŸ’¡ Suggestion: æ·»åŠ  try-catch å—å¤„ç†å¼‚å¸¸

   ğŸ“‹ ä¿®å¤æç¤ºè¯ (å¤åˆ¶åˆ° Claude Code/Codex):
   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
   â”‚ åœ¨ src/auth/api.js:45 æ·»åŠ  try-catch å¤„ç†å¼‚å¸¸   â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

> **æ¨èä½¿ç”¨åœºæ™¯**: å…³é”®ä»£ç å®¡æŸ¥ã€ç”Ÿäº§ç¯å¢ƒå‘å¸ƒå‰ã€å®‰å…¨æ•æ„ŸåŠŸèƒ½

### é…ç½®ç®¡ç†

```bash
# æŸ¥çœ‹å½“å‰é…ç½®
goodiffer config list

# è®¾ç½®é…ç½®é¡¹
goodiffer config set apiHost https://api.anthropic.com
goodiffer config set model claude-sonnet-4-5-20250929

# æ¸…é™¤é…ç½®
goodiffer config clear
```

## Output Example

```
â•­â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚  Goodiffer Analysis Report                               â”‚
â•°â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•¯

ğŸ“ Commit: feat: add user authentication

ğŸ“Š Summary: æ·»åŠ ç”¨æˆ·è®¤è¯åŠŸèƒ½ï¼ŒåŒ…å«ç™»å½•è¡¨å•å’Œ API è°ƒç”¨

ğŸ¯ Commit åŒ¹é…: âœ“ ä»£ç ä¿®æ”¹ç¬¦åˆ commit æè¿°

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ”´ ERRORS (1)

[E001] src/auth/login.js:45-52
é—®é¢˜: æœªå¤„ç† API è°ƒç”¨å¤±è´¥çš„æƒ…å†µ

ğŸ“‹ ä¿®å¤æç¤ºè¯ (å¤åˆ¶åˆ° cc/codex):
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ åœ¨ src/auth/login.js ç¬¬45è¡Œæ·»åŠ  try-catch å¤„ç†å¼‚å¸¸    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

ğŸ“ˆ ç»Ÿè®¡: 1 errors 0 warnings 0 info 0 risks
```

## Supported API Providers

| Provider | API Host | Models |
|----------|----------|--------|
| Anthropic | https://api.anthropic.com | claude-sonnet-4-5, claude-3-opus |
| OpenAI | https://api.openai.com | gpt-4o, gpt-4-turbo |
| PackyAPI | https://www.packyapi.com | claude-*, gpt-* |
| Custom | è‡ªå®šä¹‰ URL | ä»»æ„æ¨¡å‹ |

## Configuration

é…ç½®æ–‡ä»¶å­˜å‚¨åœ¨ `~/.config/goodiffer-nodejs/config.json`

å¯é…ç½®é¡¹ï¼š
- `apiHost` - API æœåŠ¡åœ°å€
- `apiKey` - API å¯†é’¥
- `model` - æ¨¡å‹åç§°
- `provider` - æä¾›å•† (claude/openai/custom)

## Requirements

- Node.js >= 18.0.0
- Git

## License

MIT
